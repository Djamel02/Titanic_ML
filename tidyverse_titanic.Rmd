---
title: "Main"
output: github_document
---

Data Preparation
----------------

```{r dataPreparation}
library(tidyverse)

train <- read.csv('train_data.csv')
test <- read.csv('test_data.csv')
class(train)
```

dplyr contains the glimpse function that enables us to take a quick look at the data.

```{r }
glimpse(train)
```

glimpse() tells us how many observations and variables there in the dataset, and also provides the class of each variable and the first few observations of each variable. It's somewhat analogous to the str() function in base R.

```{r}
glimpse(test)
```

As already mentioned, we can still run standard base R functions , such as if we would like a summary of the train and test data:

```{r}
summary(train)
```

Let's just quickly check that all the column names are the same,

```{r}
setdiff(names(train), names(test))
```

The first obvious question is: What proportion of people survived? Here we can use the summarise() (or summarize!) function from dplyr to do a quick calculation.

```{r}
summarise(train, SurvivalRate= sum(Survived)/nrow(train)*100)
```

The survival rate among the train set was only 38.63%. If we didn't have any information whatsoever about individual passengers then we could guess that they all died and be correct 61.37% of the time for the train data. Let's use this naive approach to make a prediction for the test data (setting Survived to 0 for everyone) and see what happens when we submit it :

```{r}
baseline_solution <- data.frame(PassengerID = test$PassengerId, Survived = 0)
# To submit this as an entry, just un-comment the next line and submit the .csv file 
# write.csv(baseline_solution, file = 'baseline_model.csv', row.names = F) 
```

So now that we at least have an idea of a minimum target to beat, let's collect all the data together using a full\_join() (from dplyr) and get to work on it.

```{r}
titanic <- full_join(train, test)
glimpse(titanic)
```

The Survived variable is binary, either someone died or survived. Let's make it a factor and give it each level a name so that it is more "readable". Here we use another useful package that is supplied with tidyverse, forcats, which (as the name suggests!) is specifically designed for manipulation of categorical data.
```{r}
library(forcats)
titanic <- titanic %>%
  mutate(Survived = factor(Survived)) %>%
  mutate(Survived = fct_recode(Survived, "No" = "0", "Yes" = "1"))
```

### Feature Engineering
Let’s start by recoding Sex to a factor and tidying up the labels. Then we’ll add a proportional bar plot to examine survival rate by gender.

``` {r}
titanic <- titanic %>% 
  mutate(Sex = factor(Sex)) %>% 
  mutate(Sex = fct_recode(Sex,  "Female" = "0", "Male" = "1"))
```

```{r}
ggplot(titanic[1:891,], aes(Sex, fill = Survived)) +
  geom_bar(position = "fill")+
  ylab("Survival Rate")+
  geom_hline(yintercept = (sum(train$Survived)/nrow(train)), col="white", lty = 2)+
  ggtitle("Survival Rate by gender")
```

